#!/bin/bash
#This script is used to monitor failed login attempts and the login activity of root user.
#An attempted login as root is unauthorized on this server
#A directory should be created for the consolodation of the log files that are generated by this script

#Used for log identification

today=`date '+%Y_%m_%d_'`
filename="$today.loginfail"

###Search secure log to find failed login attempts. Includes the time, IP address, username, and number of attempts that were made.

echo "Failed Login Attempts" | sudo tee -a $filename

sudo grep -a "Failed password" /var/log/auth.log | awk '{if ($11!=";") print $3,$9,$11}' | uniq -c | sudo tee -a $filename 

sudo grep -a "authentication failure" /var/log/auth.log | awk '{if ($NF!="/var/log/secure") print $NF, $1, $2, $3, $7, $8}' | sudo tee -a $filename

####Root user logins are tracked as no one should be attempting to login as root. The IP associated with the login attempt can then be blocked from the server.

echo "Root User Logins" | sudo tee -a $filename

sudo grep -a "root" /var/log/auth.log | awk '/login\[\.*/ {print $1, $2, $3, $4, $6, $7, $8}' | sudo tee -a $filename



 
